!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var s in i)("object"==typeof exports?exports:e)[s]=i[s]}}(self,(()=>(()=>{"use strict";var e={d:(t,i)=>{for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Run:()=>Run});class i{path;asset;constructor(e,t){this.path=e,this.asset=t}directory(){const e=this.path.lastIndexOf("/");return-1===e?"":this.path.substring(0,e+1)}resolveDependencies(e){null!==this.asset&&void 0!==this.asset&&"function"==typeof this.asset.resolveDependencies&&this.asset.resolveDependencies(this,e)}}function s(e,t){return new Promise((async(s,n)=>{const a=new Image;a.onload=async()=>{s(new i(t,await window.createImageBitmap(a)))},a.onerror=()=>{n(new Error(`Failed to load image at ${t}`))},a.src=e+t}))}function n(e,t){return new Promise((async(s,n)=>{const a=await fetch(e+t);a.ok?s(new i(t,await a.json())):n(new Error(`Failed to load JSON at ${t}`))}))}class a{loaders=new Map([["png",s],["json",n]]);addLoader(e,t){this.loaders.set(e,t)}getFileExtension(e){const t=e.match(/\.([0-9a-z]+)(?:[\?#]|$)/i);return t?t[1]:""}getLoaderPromise(e,t){let s=this.getFileExtension(t);return this.loaders.has(s)?this.loaders.get(s)(e,t):(console.error(`Unknown asset type: ${s}`),Promise.resolve(new i(t,null)))}async loadAssets_ex(e,t){const i=t.map((t=>this.getLoaderPromise(e,t)));try{return await Promise.all(i)}catch(e){throw console.error("Error loading assets:",e),e}}loadAssets(e,t,i){this.loadAssets_ex(e,t).then((e=>{let t=new Map;e.forEach((e=>t.set(e.path,e))),i(t)})).catch((e=>{console.error("Asset loading failed:",e)}))}}class r{static typeMap;constructor(){}static addComponentType(e,t){r.typeMap??=new Map,r.typeMap.set(e,t),console.log(e)}static create(e){const t=r.typeMap.get(e);return t?new t:new h}static createFromPrototype(e){let t=r.create(e.type);for(let i in e)t[i]=e[i];return t}}var o=function(e,t,i,s,n,a){function r(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,l=s.kind,c="getter"===l?"get":"setter"===l?"set":"value",h=!t&&e?s.static?e:e.prototype:null,d=t||(h?Object.getOwnPropertyDescriptor(h,s.name):{}),p=!1,u=i.length-1;u>=0;u--){var f={};for(var m in s)f[m]="access"===m?{}:s[m];for(var m in s.access)f.access[m]=s.access[m];f.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(r(e||null))};var y=(0,i[u])("accessor"===l?{get:d.get,set:d.set}:d[c],f);if("accessor"===l){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw new TypeError("Object expected");(o=r(y.get))&&(d.get=o),(o=r(y.set))&&(d.set=o),(o=r(y.init))&&n.unshift(o)}else(o=r(y))&&("field"===l?n.unshift(o):d[c]=o)}h&&Object.defineProperty(h,s.name,d),p=!0},l=function(e,t,i){for(var s=arguments.length>2,n=0;n<t.length;n++)i=s?t[n].call(e,i):t[n].call(e);return s?i:void 0};function c(e){return function(t){r.addComponentType(e,t)}}let h=(()=>{let e,t,i=[c("Component")],s=[];(class{static{t=this}static{const n="function"==typeof Symbol&&Symbol.metadata?Object.create(null):void 0;o(null,e={value:t},i,{kind:"class",name:t.name,metadata:n},null,s),t=e.value,n&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:n}),l(t,s)}parent;initialize(e,t){}});return t})();class d{entityCreated(e){}update(){}render(e,t){}}class p{static lastTime=performance.now();static deltaTime=0;static update(){const e=performance.now();this.deltaTime=(e-this.lastTime)/1e3,this.lastTime=e}static getDeltaTime(){return this.deltaTime}}var u;!function(e){e[e.Ground=0]="Ground",e[e.Objects=1]="Objects",e[e.Lighting=2]="Lighting",e[e.Overlay=3]="Overlay",e[e.GUI=4]="GUI"}(u||(u={}));var f=function(e,t,i,s,n,a){function r(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,l=s.kind,c="getter"===l?"get":"setter"===l?"set":"value",h=!t&&e?s.static?e:e.prototype:null,d=t||(h?Object.getOwnPropertyDescriptor(h,s.name):{}),p=!1,u=i.length-1;u>=0;u--){var f={};for(var m in s)f[m]="access"===m?{}:s[m];for(var m in s.access)f.access[m]=s.access[m];f.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(r(e||null))};var y=(0,i[u])("accessor"===l?{get:d.get,set:d.set}:d[c],f);if("accessor"===l){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw new TypeError("Object expected");(o=r(y.get))&&(d.get=o),(o=r(y.set))&&(d.set=o),(o=r(y.init))&&n.unshift(o)}else(o=r(y))&&("field"===l?n.unshift(o):d[c]=o)}h&&Object.defineProperty(h,s.name,d),p=!0},m=function(e,t,i){for(var s=arguments.length>2,n=0;n<t.length;n++)i=s?t[n].call(e,i):t[n].call(e);return s?i:void 0};class y extends h{renderLayer;render(e){}}(()=>{let e,t,i=[c("DebugGizmo")],s=[],n=y;(class extends n{static{t=this}static{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;f(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,s),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a}),m(t,s)}render(e){e.context.globalAlpha=.5,e.context.globalCompositeOperation="source-over",e.drawRectangle(this.parent.globalBounds,"red")}})})();class g extends d{renderables=[];camera;fpsQueue;isRenderable(e){return"render"in e}constructor(){super(),this.fpsQueue=[]}entityCreated(e){e.components.forEach((e=>{this.isRenderable(e)&&this.renderables.push(e)}))}render(e,t){t.context.globalAlpha=1,t.context.globalCompositeOperation="source-over";for(let e in u){let i=Number(u[e]);if(!Number.isNaN(i)){for(let e of this.renderables)e.renderLayer==i&&e.render(t);t.flush(this.camera)}}this.fpsQueue.push(p.getDeltaTime()),this.fpsQueue.length>200&&this.fpsQueue.shift();let i=this.fpsQueue.reduce(((e,t)=>e+t),0)/this.fpsQueue.length;t.context.fillStyle="black",t.context.textAlign="left",t.context.textBaseline="top",t.context.fillText(Math.round(1/i).toString(),5,5)}setCamera(e){this.camera=e}}class w{canvas;context;pendingDrawTasks;constructor(e,t){this.canvas=e,this.context=t,this.pendingDrawTasks=[]}drawSprite(e,t){this.pendingDrawTasks.push(((i,s)=>{i.drawImage(e.image,e.sourceRect.x,e.sourceRect.y,e.sourceRect.width,e.sourceRect.height,t.x-s.position.x,t.y-s.position.y,e.sourceRect.width,e.sourceRect.height)}))}drawImage(e,t,i){this.pendingDrawTasks.push(((s,n)=>{s.drawImage(e,t.x,t.y,t.width,t.height,i.x-n.position.x,i.y-n.position.y,t.width,t.height)}))}drawRectangle(e,t){this.pendingDrawTasks.push(((i,s)=>{i.fillStyle=t,i.fillRect(e.x-s.position.x,e.y-s.position.y,e.width,e.height)}))}flush(e){for(let t of this.pendingDrawTasks)t(this.context,e);this.pendingDrawTasks=[]}clearScreen(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}}class v{x;y;constructor(e,t){this.x=e,this.y=t}add(e){return new v(this.x+e.x,this.y+e.y)}negate(){return new v(-this.x,-this.y)}sub(e){return new v(this.x-e.x,this.y-e.y)}}class b{x;y;width;height;constructor(e,t,i,s){this.x=e,this.y=t,this.width=i,this.height=s}set(e,t){this.x=e.x-t.x/2,this.y=e.y-t.y/2,this.width=t.x,this.height=t.y}overlaps(e){return this.x<e.x+e.width&&this.x+this.width>e.x&&this.y<e.y+e.height&&this.y+this.height>e.y}get area(){return this.width*this.height}}class x{ID;parent;storageNode;localPosition=new v(0,0);get globalPosition(){return this.parent?this.parent.globalPosition.add(this.localPosition):this.localPosition}size=new v(1,1);get localBounds(){return new b(this.localPosition.x-this.pivot.x,this.localPosition.y-this.pivot.y,this.size.x,this.size.y)}get globalBounds(){let e=this.globalPosition;return new b(e.x-this.pivot.x,e.y-this.pivot.y,this.size.x,this.size.y)}pivot=new v(0,0);components;children;constructor(e){this.ID=e,this.parent=null,this.components=[],this.children=[]}addChild(e){e.parent=this,this.children.push(e)}getComponent(e){return this.components.find((t=>t instanceof e))}}let j=1;function E(e,t){for(let i in e)t[i]=e[i]}function T(e){return(t,s)=>new Promise((async(n,a)=>{const r=await fetch(t+s);if(!r.ok)return void a(new Error(`Failed to load JSON at ${s}`));let o=await r.json(),l=e();E(o,l),n(new i(s,l))}))}class P{modules=[];assetMap;sceneRoot;debugMode=!1;fpsQueue;constructor(e){this.assetMap=e;for(const[,t]of e)t.resolveDependencies(this);this.sceneRoot=new x(0),this.fpsQueue=[]}update(){let e=performance.now();for(let e of this.modules)e.update();let t=performance.now();this.fpsQueue.push(t-e),this.fpsQueue.length>200&&this.fpsQueue.shift()}render(e){for(let t of this.modules)t.render(this,e);let t=this.fpsQueue.reduce(((e,t)=>e+t),0)/this.fpsQueue.length;e.context.fillStyle="black",e.context.textAlign="left",e.context.textBaseline="top",e.context.fillText(t.toString(),5,25)}run(e,t){p.update(),this.update(),t(),e.clearScreen(),this.render(e),requestAnimationFrame((()=>this.run(e,t)))}addModule(e){this.modules.push(e)}createEntityFromPrototype(e,t,i){let s=j++,n=new x(s);return e.addChild(n),E(t,n),n.components=t.components.map((e=>r.createFromPrototype(e))),n.components.forEach((e=>e.parent=n)),n.components.forEach((e=>e.initialize(this,i))),this.modules.forEach((e=>e.entityCreated(n))),n}createEntitytFromTiledTemplate(e,t){if(null==t.object.properties)return console.error("Can't create entity from template without a prototype."),null;let i=t.object.properties.find((e=>"prototype"==e.name));if(null==i)return console.error("Can't create entity from template without a prototype."),null;let s=this.assetMap.get(i.value);return null==s?(console.error(`Could not find prototype ${i.value}.`),null):this.createEntityFromPrototype(e,s.asset,t)}createEntityFromTiledObject(e,t){let i=this.createEntitytFromTiledTemplate(e,t.templateAsset.asset);return i.localPosition=new v(t.x,t.y),i}}class S{components=[]}var O;!function(e){e[e.Empty=0]="Empty",e[e.Priming=1]="Priming",e[e.Ready=2]="Ready"}(O||(O={}));var D=function(e,t,i,s,n,a){function r(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,l=s.kind,c="getter"===l?"get":"setter"===l?"set":"value",h=!t&&e?s.static?e:e.prototype:null,d=t||(h?Object.getOwnPropertyDescriptor(h,s.name):{}),p=!1,u=i.length-1;u>=0;u--){var f={};for(var m in s)f[m]="access"===m?{}:s[m];for(var m in s.access)f.access[m]=s.access[m];f.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(r(e||null))};var y=(0,i[u])("accessor"===l?{get:d.get,set:d.set}:d[c],f);if("accessor"===l){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw new TypeError("Object expected");(o=r(y.get))&&(d.get=o),(o=r(y.set))&&(d.set=o),(o=r(y.init))&&n.unshift(o)}else(o=r(y))&&("field"===l?n.unshift(o):d[c]=o)}h&&Object.defineProperty(h,s.name,d),p=!0},C=function(e,t,i){for(var s=arguments.length>2,n=0;n<t.length;n++)i=s?t[n].call(e,i):t[n].call(e);return s?i:void 0};let A=(()=>{let e,t,i=[c("Tilemap")],s=[],n=y;(class extends n{static{t=this}static{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;D(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,s),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a}),C(t,s)}layer;tilemap;cacheState=O.Empty;cachedCanvas;cachedRender;initialize(e,t){this.parent.size=new v(this.layer.width*this.tilemap.tilewidth,this.layer.height*this.tilemap.tileheight)}getTile(e,t){for(let i=e.tilesets.length-1;i>=0;i--)if(t>e.tilesets[i].firstgid)return[e.tilesets[i],t-e.tilesets[i].firstgid];return[e.tilesets[0],t]}updateCache(){this.cacheState=O.Priming;const e=new v(this.layer.width*this.tilemap.tilewidth,this.layer.height*this.tilemap.tileheight);this.cachedCanvas=new OffscreenCanvas(e.x,e.y);let t=this.cachedCanvas.getContext("2d");for(let e=0;e<this.layer.width;++e)for(let i=0;i<this.layer.height;++i){let s=this.layer.data[i*this.layer.width+e];if(0==s)continue;let[n,a]=this.getTile(this.tilemap,s),r=n.tilesetAsset.getTileRect(a);t.drawImage(n.tilesetAsset.imageAsset,r.x,r.y,r.width,r.height,e*this.tilemap.tilewidth,i*this.tilemap.tileheight,this.tilemap.tilewidth,this.tilemap.tileheight)}createImageBitmap(this.cachedCanvas).then((e=>{this.cachedRender=e,this.cacheState=O.Ready}))}render(e){this.cacheState==O.Empty&&this.updateCache();let t=this.parent.globalPosition;t.x+=this.layer.x,t.y+=this.layer.y,this.cacheState==O.Priming?e.drawImage(this.cachedCanvas,new b(0,0,this.cachedCanvas.width,this.cachedCanvas.height),t):this.cacheState==O.Ready&&e.drawImage(this.cachedRender,new b(0,0,this.cachedCanvas.width,this.cachedCanvas.height),t)}});return t})();function R(...e){let t=[];Array.from(Array.isArray(e[0])?e[0]:e).forEach((e=>t=t.concat(e.split("/"))));let i=[];return t.forEach((e=>{""!=e&&"/"!=e&&"."!=e&&(".."==e?i.pop():i.push(e))})),i.join("/")}class M{name;type;value}class k{gid;height;id;name;polygon;properties;rotation;template;type;visible;width;x;y;templateAsset;resolveDependencies(e,t){null!=this.template&&""!=this.template&&(this.templateAsset=t.assetMap.get(R(e.directory(),this.template))),null!=this.properties&&(this.properties=this.properties.map((e=>{let t=new M;return E(e,t),t}))),null!=this.polygon&&(this.polygon=this.polygon.map((e=>new v(e.x,e.y))))}}class z{draworder;id;name;objects;opacity;type;visible;x;y;resolveDependencies(e,t){null!=this.objects&&(this.objects=this.objects.map((e=>{let t=new k;return E(e,t),t})),this.objects.forEach((i=>i.resolveDependencies(e,t))))}}class I{id;objectgroup;resolveDependencies(e,t){if(null!=this.objectgroup){let e=new z;E(this.objectgroup,e),this.objectgroup=e}}}class F{columns;image;imageheight;imagewidth;margin;name;spacing;tilecount;tiledversion;tileheight;tiles;tilewidth;type;version;imageAsset;resolveDependencies(e,t){this.imageAsset=t.assetMap.get(R(e.directory(),this.image)).asset,null!=this.tiles&&(this.tiles=this.tiles.map((e=>{let t=new I;return E(e,t),t})),this.tiles.forEach((i=>i.resolveDependencies(e,t))))}getTileRect(e){return new b(e%this.columns*this.tilewidth,Math.floor(e/this.columns)*this.tileheight,this.tilewidth,this.tileheight)}}class L{class;data;draworder;height;id;name;objects;opacity;type;visible;width;x;y;resolveDependencies(e,t){null!=this.objects&&(this.objects=this.objects.map((e=>{let t=new k;return E(e,t),t})),this.objects.forEach((i=>i.resolveDependencies(e,t))))}}class Q{firstgid;source;tilesetAsset;resolveDependencies(e,t){this.tilesetAsset=t.assetMap.get(R(e.directory(),this.source)).asset}}class N{compressionlevel;height;infinite;layers;nexlayerid;nextobjectid;orientation;renderorder;tiledversion;tileheight;tilesets;tilewidth;type;version;width;resolveDependencies(e,t){this.tilesets=this.tilesets.map((e=>{let t=new Q;return E(e,t),t})),this.tilesets.forEach((i=>i.resolveDependencies(e,t))),this.layers=this.layers.map((e=>{let t=new L;return E(e,t),t})),this.layers.forEach((i=>i.resolveDependencies(e,t)))}}class B{fileName;height;width;x;y;tilemapAsset;resolveDependencies(e,t){this.tilemapAsset=t.assetMap.get(e.directory()+this.fileName).asset}}class G{maps;onlyShowAdjacentMaps;type;resolveDependencies(e,t){this.maps=this.maps.map((e=>{let t=new B;return E(e,t),t})),this.maps.forEach((i=>i.resolveDependencies(e,t)))}}class ${object;tileset;type;basePath;resolveDependencies(e,t){if(this.basePath=e.directory(),null!=this.tileset){let i=new Q;E(this.tileset,i),this.tileset=i,this.tileset.resolveDependencies(e,t)}if(null!=this.object){let i=new k;E(this.object,i),this.object=i,i.resolveDependencies(e,t)}}}class U{type;spriteSheetPath;spriteSheetAsset;spriteWidth;spriteHeight;frames;frametime=10;resolveDependencies(e,t){"spritesheet"==this.type&&(this.spriteSheetAsset=t.assetMap.get(R(e.directory(),this.spriteSheetPath)).asset)}}class H extends d{animatables=[];isAnimatable(e){return"animate"in e}entityCreated(e){e.components.forEach((e=>{this.isAnimatable(e)&&this.animatables.push(e)}))}update(){this.animatables.forEach((e=>e.animate()))}}class K{position=new v(0,0);bounds=new b(-.5,-.5,1,1)}class _ extends d{updateables=[];isUpdateable(e){return"update"in e}entityCreated(e){e.components.forEach((e=>{this.isUpdateable(e)&&this.updateables.push(e)}))}update(){for(let e of this.updateables)e.update()}}class J{image;sourceRect;constructor(e,t){this.image=e,this.sourceRect=t}}var W=function(e,t,i,s,n,a){function r(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,l=s.kind,c="getter"===l?"get":"setter"===l?"set":"value",h=!t&&e?s.static?e:e.prototype:null,d=t||(h?Object.getOwnPropertyDescriptor(h,s.name):{}),p=!1,u=i.length-1;u>=0;u--){var f={};for(var m in s)f[m]="access"===m?{}:s[m];for(var m in s.access)f.access[m]=s.access[m];f.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(r(e||null))};var y=(0,i[u])("accessor"===l?{get:d.get,set:d.set}:d[c],f);if("accessor"===l){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw new TypeError("Object expected");(o=r(y.get))&&(d.get=o),(o=r(y.set))&&(d.set=o),(o=r(y.init))&&n.unshift(o)}else(o=r(y))&&("field"===l?n.unshift(o):d[c]=o)}h&&Object.defineProperty(h,s.name,d),p=!0},q=function(e,t,i){for(var s=arguments.length>2,n=0;n<t.length;n++)i=s?t[n].call(e,i):t[n].call(e);return s?i:void 0};(()=>{let e,t,i=[c("Sprite")],s=[],n=y;(class extends n{static{t=this}static{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;W(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,s),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a}),q(t,s)}sprite;render(e){e.drawSprite(this.sprite,this.parent.globalPosition.sub(this.parent.pivot))}initialize(e,t){this.sprite=new J(t.tileset.tilesetAsset.imageAsset,t.tileset.tilesetAsset.getTileRect(t.object.gid-1)),this.renderLayer=u.Objects}})})();class V{inputEvents=[];maxHistoryTime=5e3;actionMap={};initialize(){window.addEventListener("keydown",function(e){const t=this.actionMap[e.code];if(!t)return;this.inputEvents.find((e=>e.action===t&&e.pressed))||this.inputEvents.push({action:t,pressed:!0,downTime:performance.now(),upTime:null,handled:!1})}.bind(this)),window.addEventListener("keyup",function(e){const t=this.actionMap[e.code];if(!t)return;const i=this.inputEvents.find((e=>e.action===t&&e.pressed));i&&(i.pressed=!1,i.upTime=performance.now())}.bind(this))}bind(e,t){this.actionMap[e]=t}tryGetRecentInput(e,t){const i=performance.now();for(const s of this.inputEvents)if(s.action===e&&!s.handled&&(i-s.downTime<=t||!s.pressed&&s.upTime&&i-s.upTime<=t))return s;return null}check(e){return null!=this.tryGetRecentInput(e,500)}markHandled(e){for(const t of this.inputEvents)t.action===e&&(t.handled=!0)}cleanup(){const e=performance.now();for(let t=this.inputEvents.length-1;t>=0;t--){const i=this.inputEvents[t];if(i.pressed)continue;e-i.upTime>this.maxHistoryTime&&this.inputEvents.splice(t,1)}}}var X=function(e,t,i,s,n,a){function r(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,l=s.kind,c="getter"===l?"get":"setter"===l?"set":"value",h=!t&&e?s.static?e:e.prototype:null,d=t||(h?Object.getOwnPropertyDescriptor(h,s.name):{}),p=!1,u=i.length-1;u>=0;u--){var f={};for(var m in s)f[m]="access"===m?{}:s[m];for(var m in s.access)f.access[m]=s.access[m];f.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(r(e||null))};var y=(0,i[u])("accessor"===l?{get:d.get,set:d.set}:d[c],f);if("accessor"===l){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw new TypeError("Object expected");(o=r(y.get))&&(d.get=o),(o=r(y.set))&&(d.set=o),(o=r(y.init))&&n.unshift(o)}else(o=r(y))&&("field"===l?n.unshift(o):d[c]=o)}h&&Object.defineProperty(h,s.name,d),p=!0},Y=function(e,t,i){for(var s=arguments.length>2,n=0;n<t.length;n++)i=s?t[n].call(e,i):t[n].call(e);return s?i:void 0};(()=>{let e,t,i=[c("PlayerController")],s=[],n=h;(class extends n{static{t=this}static{const a="function"==typeof Symbol&&Symbol.metadata?Object.create(n[Symbol.metadata]??null):void 0;X(null,e={value:t},i,{kind:"class",name:t.name,metadata:a},null,s),t=e.value,a&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a}),Y(t,s)}input;initialize(e,t){this.input=new V,this.input.bind("KeyA","west"),this.input.bind("KeyW","north"),this.input.bind("KeyS","south"),this.input.bind("KeyD","east"),this.input.initialize()}update(){this.input.check("west")&&(this.parent.localPosition.x-=1),this.input.check("north")&&(this.parent.localPosition.y-=1),this.input.check("south")&&(this.parent.localPosition.y+=1),this.input.check("east")&&(this.parent.localPosition.x+=1),this.input.cleanup()}})})();function Run(){console.log("Starting Engine"),n("data/","manifest.json").then((e=>{let t=e.asset;const i=document.getElementById("myCanvas");i.style.imageRendering="pixelated";const s=i.getContext("2d");s.imageSmoothingEnabled=!1;const n=new a;n.addLoader("tmj",T((()=>new N))),n.addLoader("tsj",T((()=>new F))),n.addLoader("world",T((()=>new G))),n.addLoader("tj",T((()=>new $))),n.addLoader("proto",T((()=>new S))),n.addLoader("anim",T((()=>new U))),n.loadAssets("data/",t,(e=>{const t=new P(e);t.debugMode=!0,t.addModule(new _),t.addModule(new H);let n=new g;t.addModule(n);let a=t.assetMap.get("assets/test-room.tmj").asset;for(let e of a.layers){if("objectgroup"==e.type)for(let i of e.objects)null!=i.template&&""!=i.template&&t.createEntityFromTiledObject(t.sceneRoot,i);if("tilelayer"==e.type){let i=new S;i.components.push({type:"Tilemap",tilemap:a,layer:e});let s=t.createEntityFromPrototype(t.sceneRoot,i,new $).getComponent(A);null!=s&&(s.renderLayer=u[e.class])}}let r=new K;n.setCamera(r),console.log(t.sceneRoot),t.run(new w(i,s),(()=>{}))}))})).catch((e=>console.error("Failed to load asset manifest.")))}return t})()));